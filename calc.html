<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Simple Calculator</title>
    <style>
      /* Light mode */
      body.light-mode {
        background-color: #f5f5f5;
        color: #555;
      }

      /* Dark mode */
      body.dark-mode {
        background-color: #333;
        color: #fff;
      }

      #calculator {
        width: 300px;
        margin: 50px auto;
        padding: 20px;
        border: 2px solid #ccc;
        border-radius: 10px;
        background-color: #fff;
        box-shadow: 0px 5px 20px #ccc;
      }

      input {
        width: 100%;
        margin-bottom: 20px;
        padding: 10px;
        font-size: 36px;
        text-align: right;
        border: none;
        background-color: #fff;
        box-shadow: 0px 3px 10px #ccc;
        border-radius: 10px;
        color: #555;
      }

      button {
        width: 50px;
        height: 50px;
        margin: 5px;
        font-size: 20px;
        border: none;
        border-radius: 10px;
        background-color: #00a0b0;
        color: #fff;
        cursor: pointer;
        box-shadow: 0px 3px 10px #aaa;
      }

      button:hover {
        background-color: #33cccc;
        box-shadow: 0px 5px 15px #aaa;
      }

      button:active {
        background-color: #007d8c;
        box-shadow: none;
      }

      .row {
        display: flex;
        justify-content: center;
        align-items: center;
      }

      /* Toggle switch */
      .switch {
        position: absolute;
        top: 10px;
        right: 10px;
        display: inline-block;
        width: 60px;
        height: 34px;
      }

      .switch input {
        opacity: 0;
        width: 0;
        height: 0;
      }

      .slider {
        position: relative;
        display: inline-block;
        width: 100%;
        height: 100%;
        background-color: #ccc;
        border-radius: 34px;
        transition: background-color 0.3s ease;
      }

      .slider:before {
        position: absolute;
        content: "";
        height: 26px;
        width: 26px;
        left: 4px;
        bottom: 4px;
        background-color: white;
        border-radius: 50%;
        transition: transform 0.3s ease;
      }
input {
        width: 100%;
        margin-bottom: 20px;
        padding: 10px;
        font-size: 36px;
        text-align: right;
        border: none;
        background-color: #fff;
        box-shadow: 0px 3px 10px #ccc;
        border-radius: 10px;
        color: #555;
      }
      input:checked + .slider {
        background-color: #2196F3;
      }

      input:checked + .slider:before {
        transform: translateX(26px);
      }
      
    </style>
  </head>

  <body class="light-mode">
<div class="switch">
        <label>
          <input type="checkbox" onclick="toggleMode()">
          <span class="slider"></span>
        </label>
</div>
    <div class="calculator">  

<input type="text" name="" id="display" class="input">  

      <div class="row">
        <button onclick="clearDisplay()">AC</button>
        <button onclick="removeLastCharacter()">DEL</button>
        <button onclick="addToDisplay('(')">(</button>
        <button onclick="addToDisplay(')')">)</button>
      </div>
      <div class="row">
        <button onclick="addToDisplay('7')">7</button>
        <button onclick="addToDisplay('8')">8</button>
        <button onclick="addToDisplay('9')">9</button>
        <button onclick="addToDisplay('/')">/</button>
      </div>
      <div class="row">
        <button onclick="addToDisplay('4')">4</button>
        <button onclick="addToDisplay('5')">5</button>
        <button onclick="addToDisplay('6')">6</button>
        <button onclick="addToDisplay('*')">x</button>
      </div>
      <div class="row">
        <button onclick="addToDisplay('1')">1</button>
<button onclick="addToDisplay('2')">2</button>
        <button onclick="addToDisplay('3')">3</button>
        <button onclick="addToDisplay('-')">-</button>
      </div>
      <div class="row">
        <button onclick="addToDisplay('0')">0</button>
        <button onclick="addToDisplay('.')">.</button>
        <button onclick="calculateResult()">=</button>
        <button onclick="addToDisplay('+')">+</button>
      </div>
    </div>
    <script>



function toggleMode() {
  const body = document.querySelector("body");
  const switchBtn = document.querySelector(".switch input[type='checkbox']");

  if (switchBtn.checked) {
    body.classList.add("dark-mode");
    body.classList.remove("light-mode");
  } else {
    body.classList.add("light-mode");
    body.classList.remove("dark-mode");
  }
}

    const display = document.getElementById("display");

    

      function clearDisplay() {
        display.value = "";
      }

      function removeLastCharacter() {
        const value = display.value;
        display.value = value.substring(0, value.length - 1);
      }

      function addToDisplay(character) {
        display.value += character;
      }

      function calculateResult() {
        const expression = display.value;
        if (checkInput(expression)) {
          const result = calculate(expression);
          display.value = result;
        }
      }

      function checkInput(expression) {
        // Check if the input contains only numbers, operators, and parentheses
        const regex = /^[\d\s\(\)\+\-\*\/\.]+$/;
        if (!regex.test(expression)) {
          // Display an error message in the display area
          display.value = "Invalid input!";
          // Reset the input to the previous value
          return false;
        }
        return true;
      }


// uses getprecedence and applyoperation function for calculation
function calculate(expression) {
    //removes emplty spaces
  expression = expression.replace(/\s+/g, '');
      //use arrays to keep track operators and operands

  var operators = [];
  var operands = [];
  for (var i = 0; i < expression.length; i++) {
    var char = expression.charAt(i);
    if (/\d/.test(char) || char === '.') {
      var start = i;
      while (i < expression.length && (/[\d.]/.test(expression.charAt(i)))) {
        i++;
      }
      operands.push(parseFloat(expression.substring(start, i)));
      i--;
    } else if (/[+\-*/^()%]/.test(char)) {
      if (char === '(') {
        operators.push(char);
      } else if (char === ')') {
        while (operators[operators.length - 1] !== '(') {
          var operator = operators.pop();
          var operand2 = operands.pop();
          var operand1 = operands.pop();
          operands.push(applyOperation(operator, operand1, operand2));
        }
        operators.pop();
      } else {
        while (operators.length > 0 && getPrecedence(operators[operators.length - 1]) >= getPrecedence(char)) {
          var operator = operators.pop();
          var operand2 = operands.pop();
          var operand1 = operands.pop();
          operands.push(applyOperation(operator, operand1, operand2));
        }
        operators.push(char);
      }
    } else {
      throw new Error('Invalid character: ' + char);
    }
  }
  while (operators.length > 0) {
    var operator = operators.pop();
    var operand2 = operands.pop();
    var operand1 = operands.pop();
    operands.push(applyOperation(operator, operand1, operand2));
  }
  return operands.pop();
}

function getPrecedence(operator) {
    //for managing priority of the operator decides which should run first
  switch (operator) {
    case '+':
    case '-':
      return 1;
    case '*':
    case '/':
      return 2;
    case '^':
      return 3;
    case '%':
      return 4;
    default:
      return 0;
  }
}

function applyOperation(operator, operand1, operand2) {
    //takes operator and two numbers as input and applies the operator
    switch (operator) {
    case '+':
      return operand1 + operand2;
    case '-':
      return operand1 - operand2;
    case '*':
      return operand1 * operand2;
    case '/':
      return operand1 / operand2;
    case '%':
      return operand1 % operand2;
    case '^':
      return Math.pow(operand1, operand2);
    default:
      throw new Error('Invalid operator: ' + operator);
  }
}


document.getElementById("display").addEventListener("keydown", function(event) {
        if (event.key === "Enter") {
        //   EXECUTES THE EXPRESSION ON PRESSING ENTER ON KEYBOARD
            calculateResult();
        }});

display.addEventListener("input", function() {
    // TAKES BOTH TYPED AND INPUT THRU BUTTONS USING EVENT LISTENER AND DISPLAYS  INSIDE INPUT
    
    const value = display.value;
    console.log(value);
});
    </script>
  </body>
</html>